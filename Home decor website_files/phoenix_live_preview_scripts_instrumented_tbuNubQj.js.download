!function(global){const TRANSPORT_CONFIG={};TRANSPORT_CONFIG.PHOENIX_INSTANCE_ID = "PH-358854981866";
TRANSPORT_CONFIG.IS_NATIVE_APP = true;
TRANSPORT_CONFIG.PLATFORM = "win";
TRANSPORT_CONFIG.LIVE_DEV_REMOTE_WORKER_SCRIPTS_FILE_NAME = "pageLoaderWorker_m8m9cblQ.js";
TRANSPORT_CONFIG.LIVE_PREVIEW_DEBUG_ENABLED = false;
TRANSPORT_CONFIG.TRUSTED_ORIGINS_EMBED = {"http://localhost:8000":true,"http://localhost:8001":true,"http://localhost:5000":true,"http://127.0.0.1:8000":true,"http://127.0.0.1:8001":true,"http://127.0.0.1:5000":true,"phtauri://localhost":true,"https://phtauri.localhost":true,"https://phcode.live":true,"https://phcode.dev":true,"https://dev.phcode.dev":true,"https://staging.phcode.dev":true,"https://create.phcode.dev":true};
TRANSPORT_CONFIG.STRINGS = {
                UNSUPPORTED_DOM_APIS_CONFIRM: "The `window.confirm` and `window.prompt` APIs are unavailable in the embedded Live Preview of Phoenix Code. Please popout Live Preview to use these APIs in the browser."
            };
TRANSPORT_CONFIG.LIVE_PREVIEW_WEBSOCKET_CHANNEL_URL = "ws://localhost:60887/PreviewComm3QoR3JWF";
function _debugLog(...args){window.LIVE_PREVIEW_DEBUG_ENABLED&&console.log(...args)}const clientID=""+Math.round(1e9*Math.random()),worker=new Worker(TRANSPORT_CONFIG.LIVE_DEV_REMOTE_WORKER_SCRIPTS_FILE_NAME);let _workerMessageProcessor,sentTitle,sentFavIconURL;function _postLivePreviewMessage(message){worker.postMessage({type:"livePreview",message:message})}function convertImgToBase64(url,callback){if(!url)return void callback(null);let canvas=document.createElement("CANVAS");const ctx=canvas.getContext("2d"),img=new Image;img.crossOrigin="Anonymous",img.onload=function(){canvas.height=img.height,canvas.width=img.width,ctx.drawImage(img,0,0);const dataURL=canvas.toDataURL();callback(dataURL),canvas=null},img.src=url}function getAbsoluteUrl(url){if(/^(?:[a-z]+:)?\/\//i.test(url))return url;const absoluteUrl=new URL(url,window.location.href);return absoluteUrl.href}function alertPatch(message,titleText){const modal=document.createElement("div");modal.style.position="fixed",modal.style.top="0",modal.style.left="0",modal.style.width="100%",modal.style.height="100vh",modal.style.backgroundColor="rgba(0,0,0,0.5)",modal.style.display="flex",modal.style.justifyContent="center",modal.style.alignItems="center",modal.style.zIndex="1000000000";const modalContent=document.createElement("div");modalContent.style.backgroundColor="white",modalContent.style.padding="20px",modalContent.style.borderRadius="5px",modalContent.style.minWidth="300px",modalContent.style.margin="auto",modalContent.style.textAlign="center";const title=document.createElement("h3");title.textContent=titleText||"alert",title.style.marginBottom="10px";const text=document.createElement("p");text.textContent=message,text.style.marginBottom="20px";const button=document.createElement("button");button.textContent="OK",button.style.padding="10px 20px",button.style.border="none",button.style.backgroundColor="#007BFF",button.style.color="white",button.style.borderRadius="5px",button.style.cursor="pointer",button.onclick=function(){document.body.removeChild(modal)},modalContent.appendChild(title),modalContent.appendChild(text),modalContent.appendChild(button),modal.appendChild(modalContent),document.body.appendChild(modal)}function unsupportedConfirm(){alertPatch(TRANSPORT_CONFIG.STRINGS.UNSUPPORTED_DOM_APIS_CONFIRM,"window.confirm")}function unsupportedPrompt(){alertPatch(TRANSPORT_CONFIG.STRINGS.UNSUPPORTED_DOM_APIS_CONFIRM,"window.prompt")}worker.onmessage=(event=>{const type=event.data.type;switch(type){case"REDIRECT_PAGE":location.href=event.data.URL;break;default:if(_workerMessageProcessor)return _workerMessageProcessor(event);console.error("Live Preview page loader: received unknown message from worker:",event)}}),worker.postMessage({type:"setupPhoenixComm",livePreviewDebugModeEnabled:TRANSPORT_CONFIG.LIVE_PREVIEW_DEBUG_ENABLED,broadcastChannel:TRANSPORT_CONFIG.LIVE_PREVIEW_BROADCAST_CHANNEL_ID,websocketChannelURL:TRANSPORT_CONFIG.LIVE_PREVIEW_WEBSOCKET_CHANNEL_URL,clientID:clientID}),setInterval(()=>{const favIcon=document.querySelector("link[rel~='icon']"),faviconUrl=favIcon&&favIcon.href;sentFavIconURL!==faviconUrl&&(sentFavIconURL=faviconUrl,convertImgToBase64(faviconUrl,function(base64){base64||(base64="favicon.ico"),worker.postMessage({type:"updateTitleIcon",faviconBase64:base64})})),sentTitle!==document.title&&(sentTitle=document.title,worker.postMessage({type:"updateTitleIcon",title:document.title}))},1e3),global._Brackets_LiveDev_Transport={_channelOpen:!1,_callbacks:null,setCallbacks:function(callbacks){this._callbacks=callbacks},connect:function(){const self=this;_workerMessageProcessor=(event=>{_debugLog("Live Preview: Browser received event from Phoenix: ",JSON.stringify(event.data));const type=event.data.type;switch(type){case"BROWSER_CONNECT":case"BROWSER_MESSAGE":case"BROWSER_CLOSE":break;case"MESSAGE_FROM_PHOENIX":if(self._callbacks&&self._callbacks.message){const clientIDs=event.data.clientIDs,message=event.data.message;(clientIDs.includes(clientID)||0===clientIDs.length)&&self._callbacks.message(message)}break;case"PHOENIX_CLOSE":self._channelOpen=!1,self._callbacks&&self._callbacks.close&&self._callbacks.close()}}),_postLivePreviewMessage({type:"BROWSER_CONNECT",url:global.location.href,clientID:clientID}),self._channelOpen=!0,self._callbacks&&self._callbacks.connect&&self._callbacks.connect(),addEventListener("beforeunload",function(){self._channelOpen&&(self._channelOpen=!1,_postLivePreviewMessage({type:"BROWSER_CLOSE",clientID:clientID}))})},send:function(msgStr){_postLivePreviewMessage({type:"BROWSER_MESSAGE",clientID:clientID,message:msgStr})},enable:function(){this.connect()}},document.addEventListener("click",function(event){let targetElement=event.target;if(null!==targetElement&&"A"!==targetElement.tagName&&(targetElement=targetElement.parentElement),window.__PHOENIX_EMBED_INFO&&window.__PHOENIX_EMBED_INFO.isTauri&&targetElement&&"A"===targetElement.tagName&&"_blank"===targetElement.target){const href=getAbsoluteUrl(targetElement.getAttribute("href"));event.defaultPrevented||(window.parent.postMessage({handlerName:"ph-liveServer",eventName:"embeddedIframeHrefClick",href:href},"*"),event.stopImmediatePropagation(),event.preventDefault())}}),document.addEventListener("contextmenu",function(event){(document.activeElement||document.body).focus()}),document.addEventListener("keydown",function(event){!window.__PHOENIX_EMBED_INFO||"Escape"!==event.key&&"Esc"!==event.key||window.parent.postMessage({handlerName:"ph-liveServer",eventName:"embeddedEscapeKeyPressed"},"*")});const currentUrl=new URL(window.location.href),queryParams=new URLSearchParams(currentUrl.search),isExternalBrowser="true"===queryParams.get("phcodeLivePreview"),isTauri=TRANSPORT_CONFIG.IS_NATIVE_APP,platform=TRANSPORT_CONFIG.PLATFORM;let alertQueue=[],confirmCalled=!1,promptCalled=!1,addToQueue=!0;if(!isExternalBrowser){window.__PHOENIX_EMBED_INFO={isTauri:isTauri,platform:platform};const shouldPatchAlert=isTauri&&"mac"===platform;if(shouldPatchAlert){function drainAlertQueues(){addToQueue=!1,confirmCalled&&unsupportedConfirm(),promptCalled&&unsupportedPrompt();for(let i=0;i<alertQueue.length;i++)alertPatch(alertQueue[i]);alertQueue=[],window.alert=alertPatch,window.confirm=unsupportedConfirm,window.prompt=unsupportedPrompt}window.alert=function(...args){addToQueue&&alertQueue.push(...args)},window.confirm=function(){confirmCalled=!0},window.prompt=function(){promptCalled=!0},document.addEventListener("DOMContentLoaded",function(){drainAlertQueues()})}}window.addEventListener("message",function(event){TRANSPORT_CONFIG.TRUSTED_ORIGINS_EMBED[event.origin]&&"WHO_AM_I_RESPONSE"===event.data.type&&(window.__PHOENIX_EMBED_INFO||console.error("Expected window.__PHOENIX_EMBED_INFO to be set, but not???"))}),window.self!==window.parent&&window.parent.postMessage({handlerName:"ph-liveServer",eventName:"whoAmIframePhoenix",href:location.href},"*")}(this);
//# sourceMappingURL=LivePreviewTransportRemote.js.map


!function(global){var transport=global._Brackets_LiveDev_Transport,MessageBroker={handlers:{},trigger:function(msg){var msgHandlers;msg.method?(msgHandlers=this.handlers[msg.method])&&msgHandlers.length>0?msgHandlers.forEach(function(handler){try{return void handler(msg)}catch(e){return void console.error("[Brackets LiveDev] Error executing a handler for "+msg.method,e.stack)}}):console.warn("[Brackets LiveDev] No subscribers for message "+msg.method):console.error("[Brackets LiveDev] Received message without method.")},respond:function(orig,response){orig.id?(response.id=orig.id,this.send(response)):console.error("[Brackets LiveDev] Trying to send a response for a message with no ID")},on:function(method,handler){method&&handler&&(this.handlers[method]||(this.handlers[method]=[]),this.handlers[method].push(handler))},send:function(msgStr){transport.send(JSON.stringify(msgStr))}},Runtime={evaluate:function(msg){var result=eval(msg.params.expression);MessageBroker.respond(msg,{result:JSON.stringify(result)})}};MessageBroker.on("Runtime.evaluate",Runtime.evaluate);var CSS={setStylesheetText:function(msg){if(msg&&msg.params&&msg.params.text&&msg.params.url){var i,node,head=window.document.getElementsByTagName("head")[0],s=window.document.createElement("style");for(s.type="text/css",s.appendChild(window.document.createTextNode(msg.params.text)),i=0;i<window.document.styleSheets.length;i++)(node=window.document.styleSheets[i]).ownerNode.id===msg.params.url?(head.insertBefore(s,node.ownerNode),node.ownerNode.parentNode.removeChild(node.ownerNode)):node.href!==msg.params.url||node.disabled||(head.insertBefore(s,node.ownerNode),node.disabled=!0,i++);s.id=msg.params.url}},getStylesheetText:function(msg){var i,sheet,text="";for(i=0;i<window.document.styleSheets.length;i++)if((sheet=window.document.styleSheets[i]).ownerNode.id===msg.params.url)text=sheet.ownerNode.textContent;else if(sheet.href===msg.params.url&&!sheet.disabled){var j,rules;try{rules=window.document.styleSheets[i].cssRules}catch(e){if("SecurityError"!==e.name)throw e}if(!rules)return;for(j=0;j<rules.length;j++)text+=rules[j].cssText+"\n"}MessageBroker.respond(msg,{text:text})}};MessageBroker.on("CSS.setStylesheetText",CSS.setStylesheetText),MessageBroker.on("CSS.getStylesheetText",CSS.getStylesheetText);var Page={reload:function(msg){window.location.reload(msg.params.ignoreCache)}};if(MessageBroker.on("Page.reload",Page.reload),MessageBroker.on("ConnectionClose",Page.close),transport){var ProtocolManager={_documentObserver:{},_protocolHandler:{},enable:function(){transport.setCallbacks(this._protocolHandler),transport.enable()},onConnect:function(){this._documentObserver.start(window.document,transport)},onClose:function(){var body=window.document.getElementsByTagName("body")[0],overlay=window.document.createElement("div"),background=window.document.createElement("div"),status=window.document.createElement("div");overlay.style.width="100%",overlay.style.height="100%",overlay.style.zIndex=2227,overlay.style.position="fixed",overlay.style.top=0,overlay.style.left=0,background.style.backgroundColor="#fff",background.style.opacity=.5,background.style.width="100%",background.style.height="100%",background.style.position="fixed",background.style.top=0,background.style.left=0,status.textContent="Live Development Session has Ended",status.style.width="100%",status.style.color="#fff",status.style.backgroundColor="#666",status.style.position="fixed",status.style.top=0,status.style.left=0,status.style.padding="0.2em",status.style.verticalAlign="top",status.style.textAlign="center",overlay.appendChild(background),overlay.appendChild(status),body.appendChild(overlay),window.document.title="(Brackets Live Preview: closed) "+window.document.title},setDocumentObserver:function(documentOberver){documentOberver&&(this._documentObserver=documentOberver)},setProtocolHandler:function(protocolHandler){protocolHandler&&(this._protocolHandler=protocolHandler)}};global._Brackets_LiveDev_ProtocolManager=ProtocolManager;var ProtocolHandler={message:function(msgStr){var msg;try{msg=JSON.parse(msgStr)}catch(e){return void console.error("[Brackets LiveDev] Malformed message received: ",msgStr)}MessageBroker.trigger(msg)},close:function(evt){ProtocolManager.onClose()},connect:function(evt){ProtocolManager.onConnect()}};ProtocolManager.setProtocolHandler(ProtocolHandler),window.addEventListener("load",function(){ProtocolManager.enable()}),window.document.addEventListener("click",onDocumentClick)}else console.error("[Brackets LiveDev] No transport set");function _getAllInheritedSelectorsInOrder(element){let selectorsFound=new Map;const selectorsList=[];for(;element;)element.id&&selectorsList.push(`#${element.id}`),element.classList&&element.classList.forEach(cls=>{selectorsFound.get(cls)||(selectorsFound.set(cls,!0),selectorsList.push(`.${cls}`))}),element=element.parentElement;return selectorsList}function onDocumentClick(event){const selection=window.getSelection();if(!(selection.toString().length>0)){var element=event.target;element&&element.hasAttribute("data-brackets-id")&&MessageBroker.send({tagId:element.getAttribute("data-brackets-id"),nodeID:element.id,nodeClassList:element.classList,nodeName:element.nodeName,allSelectors:_getAllInheritedSelectorsInOrder(element),contentEditable:"true"===element.contentEditable,clicked:!0})}}}(this);
//# sourceMappingURL=LiveDevProtocolRemote.js.map


!function(global){var ProtocolManager=global._Brackets_LiveDev_ProtocolManager,_document=null,_transport;function inIframe(){try{return window.self!==window.top}catch(e){return!0}}function scrollToLastPosition(){let saved=JSON.parse(sessionStorage.getItem("saved-scroll-"+location.href));saved&&window.scrollTo({left:saved.scrollX,top:saved.scrollY,behavior:"instant"})}function related(){var rel={scripts:{},stylesheets:{}},i,s,j;for(i=0;i<_document.scripts.length;i++)_document.scripts[i].src&&(rel.scripts[_document.scripts[i].src]=!0);var traverseRules=function _traverseRules(sheet,base){var i,href=sheet.href,cssRules;try{cssRules=sheet.cssRules}catch(e){if("SecurityError"!==e.name)throw e}if(href&&cssRules)for(void 0===rel.stylesheets[href]&&(rel.stylesheets[href]=[]),rel.stylesheets[href].push(base),i=0;i<cssRules.length;i++)cssRules[i].href&&traverseRules(cssRules[i].styleSheet,base)};for(j=0;j<window.document.styleSheets.length;j++)s=window.document.styleSheets[j],traverseRules(s,s.href);return rel}inIframe()&&(document.savePageCtrlSDisabledByPhoenix=!0,document.addEventListener("keydown",function(e){"s"===e.key&&(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)&&e.preventDefault()},!1)),window.addEventListener("scroll",function(){sessionStorage.setItem("saved-scroll-"+location.href,JSON.stringify({scrollX:window.scrollX,scrollY:window.scrollY}))}),window.addEventListener("load",scrollToLastPosition);var Utils={isExternalStylesheet:function(node){return"LINK"===node.nodeName.toUpperCase()&&"stylesheet"===node.rel&&node.href},isExternalScript:function(node){return"SCRIPT"===node.nodeName.toUpperCase()&&node.src}},CSS={stylesheets:{},loadTimers:{},checkForStylesheetLoaded:function(href){const self=this;if(!href)return;self.loadTimers[href]&&(clearInterval(self.loadTimers[href]),delete self.loadTimers[href]);let currentPollTime=0,maxPollTime=2e4,pollInterval=50;self.loadTimers[href]=setInterval(function(){let i;if(currentPollTime>2e4)return clearInterval(self.loadTimers[href]),void delete self.loadTimers[href];for(i=0;i<window.document.styleSheets.length;i++)if(window.document.styleSheets[i].href===href){clearInterval(self.loadTimers[href]),delete self.loadTimers[href],self.notifyStylesheetAdded();break}currentPollTime+=50},50)},onStylesheetRemoved:function(url){var s=window.document.getElementById(url);s&&s.parentNode&&s.parentNode.removeChild&&s.parentNode.removeChild(s)},notifyStylesheetAdded:function(){var added={},current,newStatus;current=this.stylesheets,newStatus=related().stylesheets,Object.keys(newStatus).forEach(function(v,i){current[v]||(added[v]=newStatus[v])}),Object.keys(added).forEach(function(v,i){_transport.send(JSON.stringify({method:"StylesheetAdded",href:v,roots:[added[v]]}))}),self.stylesheets=newStatus},notifyStylesheetRemoved:function(_dontUpdateStylesheets){var self=this,removed={},newStatus,current;current=self.stylesheets,newStatus=related().stylesheets,Object.keys(current).forEach(function(v,i){newStatus[v]||(removed[v]=current[v],self.onStylesheetRemoved(current[v]))}),Object.keys(removed).forEach(function(v,i){_transport.send(JSON.stringify({method:"StylesheetRemoved",href:v,roots:[removed[v]]}))}),_dontUpdateStylesheets||(self.stylesheets=newStatus)}};function _onNodesAdded(nodes){var i;for(i=0;i<nodes.length;i++)Utils.isExternalScript(nodes[i])&&_transport.send(JSON.stringify({method:"ScriptAdded",src:nodes[i].src})),Utils.isExternalStylesheet(nodes[i])&&CSS.checkForStylesheetLoaded(nodes[i].href)}function _onNodesRemoved(nodes){var i;for(i=0;i<nodes.length;i++)Utils.isExternalScript(nodes[i])&&_transport.send(JSON.stringify({method:"ScriptRemoved",src:nodes[i].src})),Utils.isExternalStylesheet(nodes[i])&&CSS.notifyStylesheetRemoved()}function _enableListeners(){var MutationObserver=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,observer;MutationObserver?new MutationObserver(function(mutations){mutations.forEach(function(mutation){mutation.addedNodes.length>0&&_onNodesAdded(mutation.addedNodes),mutation.removedNodes.length>0&&_onNodesRemoved(mutation.removedNodes)})}).observe(_document,{childList:!0,subtree:!0}):(window.document.addEventListener("DOMNodeInserted",function niLstnr(e){_onNodesAdded([e.target])}),window.document.addEventListener("DOMNodeRemoved",function nrLstnr(e){_onNodesRemoved([e.target])}))}function start(document,transport){_transport=transport,_document=document,_enableListeners();var rel=related();_transport.send(JSON.stringify({method:"DocumentRelated",related:rel})),CSS.stylesheets=rel.stylesheets}function stop(){}var DocumentObserver={start:start,stop:stop,related:related};ProtocolManager.setDocumentObserver(DocumentObserver)}(this);
//# sourceMappingURL=DocumentObserver.js.map

window._LD=(function RemoteFunctions(config){var experimental,req,timeout;experimental=!!config&&config.experimental;var animateHighlight=function(time){req&&(window.cancelAnimationFrame(req),window.clearTimeout(timeout)),req=window.requestAnimationFrame(redrawHighlights),timeout=setTimeout(function(){window.cancelAnimationFrame(req),req=null},1e3*time)},_editHandler,HIGHLIGHT_CLASSNAME="__brackets-ld-highlight",_currentEditor,_currentMenu,_localHighlight,_remoteHighlight;function _validEvent(event){return"Mac"===window.navigator.platform.substr(0,3)?event.metaKey:event.ctrlKey}function _typeColor(type,highlight){switch(type){case"html":return highlight?"#eec":"#ffe";case"css":return highlight?"#cee":"#eff";case"js":return highlight?"#ccf":"#eef";default:return highlight?"#ddd":"#eee"}}function _screenOffset(element){var elemBounds=element.getBoundingClientRect(),body=window.document.body,offsetTop,offsetLeft;if("static"===window.getComputedStyle(body).position)offsetLeft=elemBounds.left+window.pageXOffset,offsetTop=elemBounds.top+window.pageYOffset;else{var bodyBounds=body.getBoundingClientRect();offsetLeft=elemBounds.left-bodyBounds.left,offsetTop=elemBounds.top-bodyBounds.top}return{left:offsetLeft,top:offsetTop}}function _trigger(element,name,value,autoRemove){var key="data-ld-"+name;null!=value?(element.setAttribute(key,value),autoRemove&&window.setTimeout(element.removeAttribute.bind(element,key))):element.removeAttribute(key)}function isInViewport(element){var rect=element.getBoundingClientRect(),html=window.document.documentElement;return rect.top>=0&&rect.left>=0&&rect.bottom<=(window.innerHeight||html.clientHeight)&&rect.right<=(window.innerWidth||html.clientWidth)}function getDocumentOffsetTop(element){return element.offsetTop+(element.offsetParent?getDocumentOffsetTop(element.offsetParent):0)}function Menu(element){this.element=element,_trigger(this.element,"showgoto",1,!0),window.setTimeout(window.remoteShowGoto),this.remove=this.remove.bind(this)}function Editor(element){this.onBlur=this.onBlur.bind(this),this.onKeyPress=this.onKeyPress.bind(this),this.element=element,this.element.setAttribute("contenteditable","true"),this.element.focus(),this.element.addEventListener("blur",this.onBlur),this.element.addEventListener("keypress",this.onKeyPress),this.revertText=this.element.innerHTML,_trigger(this.element,"edit",1)}function Highlight(color,trigger){this.color=color,this.trigger=!!trigger,this.elements=[],this.selector=""}function _toggleEditor(element){_currentEditor=new Editor(element)}function _toggleMenu(element){_currentMenu&&_currentMenu.remove(),_currentMenu=new Menu(element)}Menu.prototype={onClick:function(url,event){event.preventDefault(),_trigger(this.element,"goto",url,!0),this.remove()},createBody:function(){if(!this.body){var offset=_screenOffset(this.element),x=offset.left,y=offset.top+this.element.offsetHeight;this.body=window.document.createElement("div"),this.body.style.setProperty("z-index",2147483647),this.body.style.setProperty("position","absolute"),this.body.style.setProperty("left",x+"px"),this.body.style.setProperty("top",y+"px"),this.body.style.setProperty("font-size","11pt"),this.body.style.setProperty("background","#fff"),this.body.style.setProperty("border","1px solid #888"),this.body.style.setProperty("-webkit-box-shadow","2px 2px 6px 0px #ccc"),this.body.style.setProperty("border-radius","6px"),this.body.style.setProperty("padding","6px")}},addItem:function(target){var item=window.document.createElement("div");if(item.style.setProperty("padding","2px 6px"),this.body.childNodes.length>0&&item.style.setProperty("border-top","1px solid #ccc"),item.style.setProperty("cursor","pointer"),item.style.setProperty("background",_typeColor(target.type)),item.innerHTML=target.name,item.addEventListener("click",this.onClick.bind(this,target.url)),target.file){var file=window.document.createElement("i");file.style.setProperty("float","right"),file.style.setProperty("margin-left","12px"),file.innerHTML=" "+target.file,item.appendChild(file)}this.body.appendChild(item)},show:function(){this.body||this.createBody(),this.body.parentNode||window.document.body.appendChild(this.body),window.document.addEventListener("click",this.remove)},remove:function(){this.body&&this.body.parentNode&&window.document.body.removeChild(this.body),window.document.removeEventListener("click",this.remove)}},Editor.prototype={onBlur:function(event){this.element.removeAttribute("contenteditable"),this.element.removeEventListener("blur",this.onBlur),this.element.removeEventListener("keypress",this.onKeyPress),_trigger(this.element,"edit",0,!0)},onKeyPress:function(event){switch(event.which){case 13:this.element.blur();break;case 27:this.element.innerHTML=this.revertText,this.element.blur()}}},Highlight.prototype={_elementExists:function(element){var i;for(i in this.elements)if(this.elements[i]===element)return!0;return!1},_makeHighlightDiv:function(element,doAnimation){var elementBounds=element.getBoundingClientRect(),highlight=window.document.createElement("div"),elementStyling=window.getComputedStyle(element),transitionDuration=parseFloat(elementStyling.getPropertyValue("transition-duration")),animationDuration=parseFloat(elementStyling.getPropertyValue("animation-duration"));if(highlight.trackingElement=element,transitionDuration&&animateHighlight(transitionDuration),animationDuration&&animateHighlight(animationDuration),0!==elementBounds.width||0!==elementBounds.height){var realElBorder={right:elementStyling.getPropertyValue("border-right-width"),left:elementStyling.getPropertyValue("border-left-width"),top:elementStyling.getPropertyValue("border-top-width"),bottom:elementStyling.getPropertyValue("border-bottom-width")},borderBox="border-box"===elementStyling.boxSizing,innerWidth=parseFloat(elementStyling.width),innerHeight=parseFloat(elementStyling.height),outerHeight=innerHeight,outerWidth=innerWidth;borderBox||(innerWidth+=parseFloat(elementStyling.paddingLeft)+parseFloat(elementStyling.paddingRight),innerHeight+=parseFloat(elementStyling.paddingTop)+parseFloat(elementStyling.paddingBottom),outerWidth=innerWidth+parseFloat(realElBorder.right)+parseFloat(realElBorder.left),outerHeight=innerHeight+parseFloat(realElBorder.bottom)+parseFloat(realElBorder.top));var visualisations={horizontal:"left, right",vertical:"top, bottom"},drawPaddingRect=function(side){var elStyling={};return visualisations.horizontal.indexOf(side)>=0?(elStyling.width=elementStyling.getPropertyValue("padding-"+side),elStyling.height=innerHeight+"px",elStyling.top=0,borderBox&&(elStyling.height=innerHeight-parseFloat(realElBorder.top)-parseFloat(realElBorder.bottom)+"px")):(elStyling.height=elementStyling.getPropertyValue("padding-"+side),elStyling.width=innerWidth+"px",elStyling.left=0,borderBox&&(elStyling.width=innerWidth-parseFloat(realElBorder.left)-parseFloat(realElBorder.right)+"px")),elStyling[side]=0,elStyling.position="absolute",elStyling},drawMarginRect=function(side){var elStyling={},margin=[];return margin.right=parseFloat(elementStyling.getPropertyValue("margin-right")),margin.top=parseFloat(elementStyling.getPropertyValue("margin-top")),margin.bottom=parseFloat(elementStyling.getPropertyValue("margin-bottom")),margin.left=parseFloat(elementStyling.getPropertyValue("margin-left")),visualisations.horizontal.indexOf(side)>=0?(elStyling.width=elementStyling.getPropertyValue("margin-"+side),elStyling.height=outerHeight+margin.top+margin.bottom+"px",elStyling.top="-"+(margin.top+parseFloat(realElBorder.top))+"px"):(elStyling.height=elementStyling.getPropertyValue("margin-"+side),elStyling.width=outerWidth+"px",elStyling.left="-"+realElBorder.left),elStyling[side]="-"+(margin[side]+parseFloat(realElBorder[side]))+"px",elStyling.position="absolute",elStyling},setVisibility=function(el){!config.remoteHighlight.showPaddingMargin||parseInt(el.height,10)<=0||parseInt(el.width,10)<=0?el.display="none":el.display="block"},mainBoxStyles=config.remoteHighlight.stylesToSet,paddingVisualisations=[drawPaddingRect("top"),drawPaddingRect("right"),drawPaddingRect("bottom"),drawPaddingRect("left")],marginVisualisations,setupVisualisations=function(arr,config){var i;for(i=0;i<arr.length;i++){setVisibility(arr[i]),arr[i].transform="none";var el=window.document.createElement("div"),styles;_setStyleValues(Object.assign({},config,arr[i]),el.style),highlight.appendChild(el)}};setupVisualisations([drawMarginRect("top"),drawMarginRect("right"),drawMarginRect("bottom"),drawMarginRect("left")],config.remoteHighlight.marginStyling),setupVisualisations(paddingVisualisations,config.remoteHighlight.paddingStyling),highlight.className=HIGHLIGHT_CLASSNAME;var offset=_screenOffset(element),stylesToSet={left:offset.left+"px",top:offset.top+"px",width:elementBounds.width+"px",height:elementBounds.height+"px","z-index":2e6,margin:0,padding:0,position:"absolute","pointer-events":"none","box-shadow":"0 0 1px #fff","box-sizing":elementStyling.getPropertyValue("box-sizing"),"border-right":elementStyling.getPropertyValue("border-right"),"border-left":elementStyling.getPropertyValue("border-left"),"border-top":elementStyling.getPropertyValue("border-top"),"border-bottom":elementStyling.getPropertyValue("border-bottom"),"border-color":config.remoteHighlight.borderColor},mergedStyles=Object.assign({},stylesToSet,config.remoteHighlight.stylesToSet),animateStartValues=config.remoteHighlight.animateStartValue,animateEndValues=config.remoteHighlight.animateEndValue,transitionValues={"transition-property":"opacity, background-color, transform","transition-duration":"300ms, 2.3s"};_setStyleValues(mergedStyles,highlight.style),_setStyleValues(doAnimation?animateStartValues:animateEndValues,highlight.style),doAnimation&&(_setStyleValues(transitionValues,highlight.style),window.setTimeout(function(){_setStyleValues(animateEndValues,highlight.style)},20)),window.document.body.appendChild(highlight)}function _setStyleValues(styleValues,obj){var prop;for(prop in styleValues)obj.setProperty(prop,styleValues[prop])}},add:function(element,doAnimation){if(!this._elementExists(element)&&element!==window.document){if(this.trigger&&_trigger(element,"highlight",1),(!window.event||window.event instanceof MessageEvent)&&!isInViewport(element)){var top=getDocumentOffsetTop(element);top&&(top-=window.innerHeight/2,window.scrollTo(0,top))}this.elements.push(element),this._makeHighlightDiv(element,doAnimation)}},clear:function(){var i,highlights=window.document.querySelectorAll("."+HIGHLIGHT_CLASSNAME),body=window.document.body;for(i=0;i<highlights.length;i++)body.removeChild(highlights[i]);if(this.trigger)for(i=0;i<this.elements.length;i++)_trigger(this.elements[i],"highlight",0);this.elements=[]},redraw:function(){var i,highlighted;for(highlighted=this.selector?window.document.querySelectorAll(this.selector):this.elements.slice(0),this.clear(),i=0;i<highlighted.length;i++)this.add(highlighted[i],!1)}};var _setup=!1;function onMouseOver(event){_validEvent(event)&&_localHighlight.add(event.target,!0)}function onMouseOut(event){_validEvent(event)&&_localHighlight.clear()}function onMouseMove(event){onMouseOver(event),window.document.removeEventListener("mousemove",onMouseMove)}function onClick(event){_validEvent(event)&&(event.preventDefault(),event.stopPropagation(),event.altKey?_toggleEditor(event.target):_toggleMenu(event.target))}function onKeyUp(event){_setup&&!_validEvent(event)&&(window.document.removeEventListener("keyup",onKeyUp),window.document.removeEventListener("mouseover",onMouseOver),window.document.removeEventListener("mouseout",onMouseOut),window.document.removeEventListener("mousemove",onMouseMove),window.document.removeEventListener("click",onClick),_localHighlight.clear(),_localHighlight=void 0,_setup=!1)}function onKeyDown(event){!_setup&&_validEvent(event)&&(window.document.addEventListener("keyup",onKeyUp),window.document.addEventListener("mouseover",onMouseOver),window.document.addEventListener("mouseout",onMouseOut),window.document.addEventListener("mousemove",onMouseMove),window.document.addEventListener("click",onClick),_localHighlight=new Highlight("#ecc",!0),_setup=!0)}function showGoto(targets){if(_currentMenu){var i;for(i in _currentMenu.createBody(),targets)_currentMenu.addItem(targets[i]);_currentMenu.show()}}function hideHighlight(){_remoteHighlight&&(_remoteHighlight.clear(),_remoteHighlight=null)}function highlight(node,clear){_remoteHighlight||(_remoteHighlight=new Highlight("#cfc")),clear&&_remoteHighlight.clear(),_remoteHighlight.add(node,!0)}function highlightRule(rule){hideHighlight();var i,nodes=window.document.querySelectorAll(rule);for(i=0;i<nodes.length;i++)highlight(nodes[i]);_remoteHighlight.selector=rule}function redrawHighlights(){_remoteHighlight&&_remoteHighlight.redraw()}function _scrollHandler(e){e.target===window.document?redrawHighlights():(_remoteHighlight||_localHighlight)&&window.setTimeout(redrawHighlights,0)}function DOMEditHandler(htmlDocument){this.htmlDocument=htmlDocument,this.rememberedNodes=null,this.entityParseParent=htmlDocument.createElement("div")}function _isRawTextNode(node){return node.nodeType===Node.ELEMENT_NODE&&/script|style|noscript|noframes|noembed|iframe|xmp/i.test(node.tagName)}function applyDOMEdits(edits){_editHandler.apply(edits)}function _domElementToJSON(elem){var json={tag:elem.tagName.toLowerCase(),attributes:{},children:[]},i,len,node,value;for(len=elem.attributes.length,i=0;i<len;i++)value="data-brackets-id"===(node=elem.attributes.item(i)).name?parseInt(node.value,10):node.value,json.attributes[node.name]=value;for(len=elem.childNodes.length,i=0;i<len;i++)(node=elem.childNodes.item(i)).nodeType===Node.ELEMENT_NODE&&node.className!==HIGHLIGHT_CLASSNAME?json.children.push(_domElementToJSON(node)):node.nodeType===Node.TEXT_NODE&&json.children.push({content:node.nodeValue});return json}function getSimpleDOM(){return JSON.stringify(_domElementToJSON(window.document.documentElement))}function updateConfig(newConfig){return config=JSON.parse(newConfig),JSON.stringify(config)}return window.addEventListener("resize",redrawHighlights),window.addEventListener("scroll",_scrollHandler,!0),DOMEditHandler.prototype._queryBracketsID=function(id){if(!id)return null;if(this.rememberedNodes&&this.rememberedNodes[id])return this.rememberedNodes[id];var results=this.htmlDocument.querySelectorAll("[data-brackets-id='"+id+"']");return results&&results[0]},DOMEditHandler.prototype._insertChildNode=function(targetElement,childElement,edit){var before=this._queryBracketsID(edit.beforeID),after=this._queryBracketsID(edit.afterID);edit.firstChild?before=targetElement.firstChild:edit.lastChild&&(after=targetElement.lastChild),before?targetElement.insertBefore(childElement,before):after&&after!==targetElement.lastChild?targetElement.insertBefore(childElement,after.nextSibling):targetElement.appendChild(childElement)},DOMEditHandler.prototype._parseEntities=function(text){var result;return this.entityParseParent.innerHTML=text,result=this.entityParseParent.textContent,this.entityParseParent.textContent="",result},DOMEditHandler.prototype._textReplace=function(targetElement,edit){function prevIgnoringHighlights(node){do{node=node.previousSibling}while(node&&node.className===HIGHLIGHT_CLASSNAME);return node}function nextIgnoringHighlights(node){do{node=node.nextSibling}while(node&&node.className===HIGHLIGHT_CLASSNAME);return node}function lastChildIgnoringHighlights(node){return(node=node.childNodes.length?node.childNodes.item(node.childNodes.length-1):null)&&node.className===HIGHLIGHT_CLASSNAME&&(node=prevIgnoringHighlights(node)),node}for(var start=edit.afterID?this._queryBracketsID(edit.afterID):null,startMissing=edit.afterID&&!start,end=edit.beforeID?this._queryBracketsID(edit.beforeID):null,endMissing=edit.beforeID&&!end,moveNext=start&&nextIgnoringHighlights(start),current=moveNext||end&&prevIgnoringHighlights(end)||lastChildIgnoringHighlights(targetElement),next,textNode=void 0!==edit.content?this.htmlDocument.createTextNode(_isRawTextNode(targetElement)?edit.content:this._parseEntities(edit.content)):null,lastRemovedWasText,isText;current&&current!==end&&(isText=current.nodeType===Node.TEXT_NODE,next=moveNext?nextIgnoringHighlights(current):prevIgnoringHighlights(current),!(current.nodeType===Node.ELEMENT_NODE||(startMissing||endMissing)&&isText&&lastRemovedWasText));)lastRemovedWasText=isText,current.remove?current.remove():current.parentNode&&current.parentNode.removeChild&&current.parentNode.removeChild(current),current=next;textNode&&(start&&start.nextSibling?targetElement.insertBefore(textNode,start.nextSibling):end?targetElement.insertBefore(textNode,end):targetElement.appendChild(textNode))},DOMEditHandler.prototype.apply=function(edits){var targetID,targetElement,childElement,self=this;this.rememberedNodes={},edits.forEach(function(edit){var editIsSpecialTag="elementInsert"===edit.type&&("html"===edit.tag||"head"===edit.tag||"body"===edit.tag);if("rememberNodes"!==edit.type)if(targetID=edit.type.match(/textReplace|textDelete|textInsert|elementInsert|elementMove/)?edit.parentID:edit.tagID,(targetElement=self._queryBracketsID(targetID))||editIsSpecialTag)switch(edit.type){case"attrChange":case"attrAdd":targetElement.setAttribute(edit.attribute,self._parseEntities(edit.value));break;case"attrDelete":targetElement.removeAttribute(edit.attribute);break;case"elementDelete":targetElement.remove?targetElement.remove():targetElement.parentNode&&targetElement.parentNode.removeChild&&targetElement.parentNode.removeChild(targetElement);break;case"elementInsert":childElement=null,editIsSpecialTag&&((childElement=self.htmlDocument["html"===edit.tag?"documentElement":edit.tag])||(editIsSpecialTag=!1)),editIsSpecialTag||(childElement=self.htmlDocument.createElement(edit.tag)),Object.keys(edit.attributes).forEach(function(attr){childElement.setAttribute(attr,self._parseEntities(edit.attributes[attr]))}),childElement.setAttribute("data-brackets-id",edit.tagID),editIsSpecialTag||self._insertChildNode(targetElement,childElement,edit);break;case"elementMove":childElement=self._queryBracketsID(edit.tagID),self._insertChildNode(targetElement,childElement,edit);break;case"textInsert":var textElement=self.htmlDocument.createTextNode(_isRawTextNode(targetElement)?edit.content:self._parseEntities(edit.content));self._insertChildNode(targetElement,textElement,edit);break;case"textReplace":case"textDelete":self._textReplace(targetElement,edit)}else console.error("data-brackets-id="+targetID+" not found");else edit.tagIDs.forEach(function(tagID){var node=self._queryBracketsID(tagID);self.rememberedNodes[tagID]=node,node.remove?node.remove():node.parentNode&&node.parentNode.removeChild&&node.parentNode.removeChild(node)})}),this.rememberedNodes={},redrawHighlights()},_editHandler=new DOMEditHandler(window.document),experimental&&window.document.addEventListener("keydown",onKeyDown),{DOMEditHandler:DOMEditHandler,showGoto:showGoto,hideHighlight:hideHighlight,highlight:highlight,highlightRule:highlightRule,redrawHighlights:redrawHighlights,applyDOMEdits:applyDOMEdits,getSimpleDOM:getSimpleDOM,updateConfig:updateConfig}}
//# sourceMappingURL=RemoteFunctions.js.map
({"experimental":false,"debug":true,"highlight":true,"highlightConfig":{"borderColor":{"r":255,"g":229,"b":153,"a":0.66},"contentColor":{"r":111,"g":168,"b":220,"a":0.55},"marginColor":{"r":246,"g":178,"b":107,"a":0.66},"paddingColor":{"r":147,"g":196,"b":125,"a":0.66},"showInfo":true},"remoteHighlight":{"animateStartValue":{"background-color":"rgba(0, 162, 255, 0.5)","opacity":0},"animateEndValue":{"background-color":"rgba(0, 162, 255, 0)","opacity":0.6},"paddingStyling":{"border-width":"1px","border-style":"dashed","border-color":"rgba(0, 162, 255, 0.5)"},"marginStyling":{"background-color":"rgba(21, 165, 255, 0.58)"},"borderColor":"rgba(21, 165, 255, 0.85)","showPaddingMargin":true}}))
